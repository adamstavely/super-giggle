<div class="advanced-search-panel" [class.open]="isOpen" (click)="$event.stopPropagation()">
  <div class="advanced-search-overlay" *ngIf="isOpen" (click)="onClose()"></div>
  <div class="advanced-search-container">
    <div class="advanced-search-header">
      <div class="header-content">
        <h2>Advanced Search</h2>
        <p class="subtitle">Use advanced options to refine your search</p>
      </div>
      <button mat-icon-button class="close-button" (click)="onClose()" aria-label="Close advanced search">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <form [formGroup]="advancedSearchForm" (ngSubmit)="onSubmit()" class="advanced-search-form">
      <mat-card class="search-card">
      <mat-card-header>
        <mat-card-title>Search Terms</mat-card-title>
        <mat-card-subtitle>Specify what you're looking for</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <!-- Exact Phrase -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Exact Phrase</mat-label>
          <input matInput formControlName="exactPhrase" placeholder="e.g., &quot;employee handbook&quot;">
          <mat-hint>Words in quotes will be searched as an exact phrase</mat-hint>
        </mat-form-field>

        <!-- All Words -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>All of these words</mat-label>
          <input matInput formControlName="allWords" placeholder="e.g., employee benefits">
          <mat-hint>All words must appear in the results</mat-hint>
        </mat-form-field>

        <!-- Any Words -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Any of these words</mat-label>
          <input matInput formControlName="anyWords" placeholder="e.g., vacation time off">
          <mat-hint>At least one of these words must appear</mat-hint>
        </mat-form-field>

        <!-- None Words -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>None of these words</mat-label>
          <input matInput formControlName="noneWords" placeholder="e.g., confidential private">
          <mat-hint>Exclude results containing these words</mat-hint>
        </mat-form-field>

        <!-- Boolean Operator -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Boolean Operator</mat-label>
          <mat-select formControlName="booleanOperator">
            <mat-option *ngFor="let op of booleanOperators" [value]="op.value">
              {{ op.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </mat-card-content>
    </mat-card>

    <mat-card class="search-card">
      <mat-card-header>
        <mat-card-title>Field-Specific Search</mat-card-title>
        <mat-card-subtitle>Search within specific fields</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <!-- Title -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Title Contains</mat-label>
          <input matInput formControlName="titleContains" placeholder="e.g., handbook">
          <mat-hint>Search only in document titles</mat-hint>
        </mat-form-field>

        <!-- Author -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Author Contains</mat-label>
          <input matInput formControlName="authorContains" placeholder="e.g., John Smith">
          <mat-hint>Search by author name</mat-hint>
        </mat-form-field>

        <!-- Content -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Content Contains</mat-label>
          <input matInput formControlName="contentContains" placeholder="e.g., policy">
          <mat-hint>Search only in document content</mat-hint>
        </mat-form-field>
      </mat-card-content>
    </mat-card>

    <mat-card class="search-card">
      <mat-card-header>
        <mat-card-title>Filters</mat-card-title>
        <mat-card-subtitle>Narrow down your search results</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <!-- File Formats -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>File Formats</mat-label>
          <mat-select formControlName="fileFormats" multiple>
            <mat-option *ngFor="let format of fileFormats" [value]="format.value">
              {{ format.label }}
            </mat-option>
          </mat-select>
          <mat-hint>Select one or more file formats</mat-hint>
        </mat-form-field>

        <!-- Content Types -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Content Types</mat-label>
          <mat-select formControlName="contentTypes" multiple>
            <mat-option *ngFor="let type of contentTypes" [value]="type.value">
              {{ type.label }}
            </mat-option>
          </mat-select>
          <mat-hint>Select one or more content types</mat-hint>
        </mat-form-field>

        <!-- Source Systems -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Sources</mat-label>
          <mat-select formControlName="sourceSystems" multiple>
            <mat-option *ngFor="let source of sourceSystems" [value]="source.value">
              {{ source.label }}
            </mat-option>
          </mat-select>
          <mat-hint>Select one or more sources</mat-hint>
        </mat-form-field>

        <!-- Date Range -->
        <div class="date-range-container">
          <mat-form-field appearance="outline" class="date-field">
            <mat-label>Date From</mat-label>
            <input matInput [matDatepicker]="pickerFrom" formControlName="dateFrom">
            <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
            <mat-datepicker #pickerFrom></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" class="date-field">
            <mat-label>Date To</mat-label>
            <input matInput [matDatepicker]="pickerTo" formControlName="dateTo">
            <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
            <mat-datepicker #pickerTo></mat-datepicker>
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

      <!-- Action Buttons -->
      <div class="form-actions">
        <button mat-raised-button color="primary" type="submit" [disabled]="advancedSearchForm.invalid">
          <mat-icon>search</mat-icon>
          Search
        </button>
        <button mat-button type="button" (click)="onClear()">
          <mat-icon>clear</mat-icon>
          Clear
        </button>
      </div>
    </form>
  </div>
</div>
